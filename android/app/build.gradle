import groovy.json.JsonSlurper

apply plugin: 'com.android.application'

def signConfigFile = new File("$projectDir/signConfig.json")
def signConfigJson = new JsonSlurper().parseText(signConfigFile.text)

def _versionName = "1.0.0"

if(!project.hasProperty('newVersion')){
    println "newVersion is undefined!"
} else {
    _versionName = newVersion;
}

def (versionMajor, versionMinor, versionPatch) = _versionName.tokenize('.')
def _versionCode = versionMajor.toInteger() * 10000 + versionMinor.toInteger() * 100 + versionPatch.toInteger()
println "versionName: " + _versionName
println "versionCode: " + _versionCode

android {
    compileSdkVersion 23
    buildToolsVersion "23.0.1"

    defaultConfig {
        applicationId "com.publicradionative"
        minSdkVersion 21
        targetSdkVersion 22
        versionCode _versionCode
        versionName _versionName
        ndk {
            abiFilters "armeabi-v7a", "x86"
        }
    }

    signingConfigs {

        release {
            storeFile file("public-radio.jks")
            storePassword signConfigJson.storePassword
            keyAlias signConfigJson.keyAlias
            keyPassword signConfigJson.keyPassword
        }
    }

    buildTypes {
        release {
            signingConfig signingConfigs.release
            minifyEnabled false  // Set this to true to enable Proguard
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }
}

apply plugin: 'com.github.triplet.play'

play {
    jsonFile = file('keys.json')
}

dependencies {
    compile fileTree(dir: 'libs', include: ['*.jar'])
    compile 'com.android.support:support-v4:23.0.0'
    compile 'com.android.support:appcompat-v7:23.0.0'
    compile 'com.android.support:cardview-v7:23.0.0'
    compile 'com.facebook.react:react-native:0.13.+'

    compile project(':vksdk_library')

    compile project(':react-native-vector-icons')
}
